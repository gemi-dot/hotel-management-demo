{% extends "hotel/base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>üè® Room Occupancy Report</h2>
    <!-- Add Dashboard Button -->
    <div class="mb-3">
        <a href="{% url 'dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
    </div>

    <form method="get" class="mb-4 row g-3">
        <div class="col-auto">
            <input type="date" name="start_date" value="{{ start_date }}" class="form-control">
        </div>
        <div class="col-auto">
            <input type="date" name="end_date" value="{{ end_date }}" class="form-control">
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Filter</button>
        </div>
    </form>

    <table class="table table-bordered table-hover">
        <thead class="table-light">
            <tr>
                <th>Room Number</th>
                <th>Room Type</th>
                <th>Capacity</th>
                <th>Price</th>
                <th>Status</th>
                <th>Booking Details</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in room_occupancy %}
                <tr>
                    <td>{{ entry.room.number }}</td>
                    <td>{{ entry.room.room_type }}</td>
                    <td>{{ entry.room.capacity }}</td>
                    <td>‚Ç±{{ entry.room.price }}</td>
                    <td>
                        {% if entry.status == "Occupied" %}
                            <span class="badge bg-danger">{{ entry.status }}</span>
                        {% else %}
                            <span class="badge bg-success">{{ entry.status }}</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if entry.status == "Occupied" and entry.booking %}
                            Guest: {{ entry.booking.guest.name }}<br>
                            Check-in: {{ entry.booking.check_in|date:"M d, Y" }}<br>
                            Check-out: {{ entry.booking.check_out|date:"M d, Y" }}
                        {% else %}
                            ‚Äî No active booking ‚Äî
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
